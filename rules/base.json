[
  {
    "id": "PS-001",
    "name": "Ignore Previous Instructions",
    "description": "Attempts to override earlier instructions.",
    "pattern": "\\b(ignore|disregard|forget)\\b.{0,40}\\b(previous|above|prior)\\b.{0,40}\\b(instruction|prompt|message)s?\\b",
    "severity": "block",
    "tags": ["override", "jailbreak"],
    "contexts": ["chat", "tool_output", "skill_download"],
    "flags": "is"
  },
  {
    "id": "PS-002",
    "name": "Prompt Exfiltration Request",
    "description": "Requests to reveal hidden/system prompts.",
    "pattern": "\\b(show|reveal|print|dump|expose)\\b.{0,40}\\b(system prompt|hidden prompt|developer prompt|instructions?)\\b",
    "severity": "block",
    "tags": ["exfiltration"],
    "contexts": ["chat", "tool_output", "skill_download"],
    "flags": "is"
  },
  {
    "id": "PS-003",
    "name": "Role Override",
    "description": "Attempts to re-assign model role or authority.",
    "pattern": "\\b(you are now|act as|pretend to be)\\b.{0,40}\\b(system|developer|administrator|root)\\b",
    "severity": "warn",
    "tags": ["role_override"],
    "contexts": ["chat", "skill_download"],
    "flags": "is"
  },
  {
    "id": "PS-004",
    "name": "Secret/Data Exfiltration",
    "description": "Requests access to sensitive files or secrets.",
    "pattern": "\\b(read|cat|open|download|exfiltrate|leak)\\b.{0,50}\\b(/etc/passwd|\\.ssh|api key|token|credential|secret)s?\\b",
    "severity": "block",
    "tags": ["exfiltration", "secrets"],
    "contexts": ["chat", "tool_output", "skill_download"],
    "flags": "is"
  },
  {
    "id": "PS-005",
    "name": "Disable Safety",
    "description": "Attempts to disable safeguards/validation.",
    "pattern": "\\b(do not|don't|never)\\b.{0,24}\\b(validate|sanitize|filter|check safety|enforce policy)\\b",
    "severity": "warn",
    "tags": ["safety_bypass"],
    "contexts": ["chat", "tool_output", "skill_download"],
    "flags": "is"
  },
  {
    "id": "PS-006",
    "name": "Obfuscated Payload Hint",
    "description": "References encoded payload instruction hiding.",
    "pattern": "\\b(base64|rot13|hex|encoded payload|obfuscated)\\b.{0,30}\\b(instructions?|prompt|payload|decode)\\b",
    "severity": "warn",
    "tags": ["obfuscation"],
    "contexts": ["chat", "tool_output", "skill_download"],
    "flags": "is"
  },
  {
    "id": "PS-007",
    "name": "Prompt Boundary Markers",
    "description": "Markers often used in prompt leakage/jailbreak templates.",
    "pattern": "(<\\|im_start\\|>|<\\|im_end\\|>|BEGIN SYSTEM PROMPT|END SYSTEM PROMPT)",
    "severity": "warn",
    "tags": ["template_abuse"],
    "contexts": ["chat", "tool_output", "skill_download"],
    "flags": "i"
  },
  {
    "id": "PS-008",
    "name": "Known Jailbreak Phrase",
    "description": "Common jailbreak phrases from known prompt attacks.",
    "pattern": "\\b(do anything now|jailbreak mode|developer mode enabled|policy bypass)\\b",
    "severity": "block",
    "tags": ["jailbreak"],
    "contexts": ["chat", "tool_output", "skill_download"],
    "flags": "i"
  },
  {
    "id": "PS-009",
    "name": "Private Key Block",
    "description": "Looks like a pasted private key (PEM/SSH).",
    "pattern": "-----BEGIN [A-Z0-9 ]+PRIVATE KEY-----[\\s\\S]*?-----END [A-Z0-9 ]+PRIVATE KEY-----",
    "severity": "block",
    "tags": ["secrets", "private_key"],
    "contexts": ["chat", "tool_output", "skill_download"],
    "flags": "m"
  },
  {
    "id": "PS-010",
    "name": "OpenAI-Style API Key",
    "description": "Looks like an OpenAI-style API key/token.",
    "pattern": "\\bsk-(?:proj-)?[A-Za-z0-9_-]{20,}\\b",
    "severity": "block",
    "tags": ["secrets", "api_key"],
    "contexts": ["chat", "tool_output", "skill_download"],
    "flags": ""
  },
  {
    "id": "PS-011",
    "name": "GitHub Token",
    "description": "Looks like a GitHub personal access token.",
    "pattern": "\\b(ghp_[A-Za-z0-9]{20,}|github_pat_[A-Za-z0-9_]{20,})\\b",
    "severity": "block",
    "tags": ["secrets", "api_key"],
    "contexts": ["chat", "tool_output", "skill_download"],
    "flags": ""
  },
  {
    "id": "PS-012",
    "name": "Slack Token",
    "description": "Looks like a Slack token.",
    "pattern": "\\bxox[baprs]-[A-Za-z0-9-]{10,}\\b",
    "severity": "block",
    "tags": ["secrets", "api_key"],
    "contexts": ["chat", "tool_output", "skill_download"],
    "flags": ""
  },
  {
    "id": "PS-013",
    "name": "AWS Access Key ID",
    "description": "Looks like an AWS access key id.",
    "pattern": "\\bAKIA[0-9A-Z]{16}\\b",
    "severity": "block",
    "tags": ["secrets", "api_key"],
    "contexts": ["chat", "tool_output", "skill_download"],
    "flags": ""
  },
  {
    "id": "PS-014",
    "name": "JWT Token",
    "description": "Looks like a JWT (could contain sensitive claims).",
    "pattern": "\\beyJ[A-Za-z0-9_-]{10,}\\.[A-Za-z0-9_-]{10,}\\.[A-Za-z0-9_-]{10,}\\b",
    "severity": "block",
    "tags": ["secrets", "token"],
    "contexts": ["chat", "tool_output", "skill_download"],
    "flags": ""
  },
  {
    "id": "PS-015",
    "name": "Password/Secret Assignment",
    "description": "Explicitly assigns a password/token/secret in text.",
    "pattern": "\\b(passwort|password|api[- _]?key|token|secret)\\b\\s*[:=]\\s*\\S{6,}",
    "severity": "block",
    "tags": ["secrets"],
    "contexts": ["chat", "tool_output", "skill_download"],
    "flags": "i"
  }
]
